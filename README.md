# FileDrop

P2P файловый обмен через relay-сервер. Работает между любыми ОС (Linux, macOS, Windows).

## Установка

```bash
curl -fsSL https://raw.githubusercontent.com/SettlerNVG/filedrop/main/install.sh | bash
```

Или скачай бинарник из [Releases](https://github.com/SettlerNVG/filedrop/releases).

## Возможности

- ✅ Передача файлов любого размера (потоковая, не грузит RAM)
- ✅ Передача папок с сохранением структуры  
- ✅ Шифрование AES-256-GCM (end-to-end)
- ✅ Сжатие данных (gzip)
- ✅ Докачка при обрыве соединения
- ✅ Прогресс-бар со скоростью
- ✅ TUI интерфейс — видеть онлайн пользователей и передавать файлы
- ✅ Автоподключение к публичному relay

## Быстрый старт

Клиент автоматически подключается к публичному relay-серверу (адрес обновляется динамически).

### TUI режим (рекомендуется)

```bash
filedrop-tui
```

В TUI:
- Видеть всех онлайн пользователей
- Выбрать пользователя и отправить файл
- Принять входящие передачи

### CLI режим

```bash
# Отправить файл
filedrop send myfile.zip
# Получишь код: A1B2C3

# Получить файл  
filedrop receive A1B2C3
```

## Как это работает

```
┌──────────────┐                ┌──────────────┐                ┌──────────────┐
│    Sender    │ ──── TCP ────► │    Relay     │ ◄──── TCP ──── │   Receiver   │
│              │   encrypted    │   (ngrok)    │   encrypted    │              │
└──────────────┘                └──────────────┘                └──────────────┘
```

1. Владелец запускает relay с публичным доступом через ngrok
2. Адрес relay автоматически публикуется в этом репозитории
3. Клиенты при запуске читают актуальный адрес и подключаются

## Использование своего relay

```bash
# Через флаг
filedrop -relay myserver:9000 send file.zip
filedrop-tui -relay myserver:9000

# Через переменную окружения
export FILEDROP_RELAY=myserver:9000

# Через конфиг файл
echo "myserver:9000" > ~/.filedrop/relay
```

## Запуск relay-сервера

### Локально (для тестов)

```bash
make run-relay
```

### Публично (через ngrok)

Требуется ngrok с привязанной картой для TCP туннелей.

```bash
# Установка
brew install ngrok
ngrok config add-authtoken <your-token>

# Запуск
make run-relay-public
```

Скрипт автоматически:
- Запустит relay-сервер
- Создаст ngrok туннель  
- Опубликует адрес в репозиторий
- Клиенты автоматически подключатся

## Флаги

| Флаг | Описание |
|------|----------|
| `-relay` | Адрес relay-сервера |
| `-output` | Папка для сохранения |
| `-password` | Пароль шифрования |
| `-compress` | Включить сжатие |

## TUI управление

| Клавиша | Действие |
|---------|----------|
| `1` / `u` | Список онлайн пользователей |
| `2` / `p` | Входящие запросы |
| `r` | Обновить |
| `Enter` | Выбрать |
| `Esc` | Назад |
| `q` | Выход |

## License

MIT
